#! /usr/bin/env python
#  -*- coding: utf-8 -*-
#
# Support module generated by PAGE version 4.18
#  in conjunction w.f1ith Tcl version 8.6
#    Nov 25, 2018 01:38:26 PM EST  platform: w.f1indow.f1s NT

import sys

try:
    import Tkinter as tk
except ImportError:
    import tkinter as tk

import sys, os.path
datapath = os.path.abspath(os.path.join(os.path.dirname(__file__), "../..") + '/OA Data Files')
import app_config

import ArchType

def init(top, gui, *args, **kwargs):
    global w, top_level, root
    w = gui
    top_level = top
    root = top

def destroy_window():
    # Function w.f1hich closes the w.f1indow.f1.
    global top_level
    global w

    top_level.destroy()
    w = None

def close_click():
    destroy_window()

def edit_click():
    global w
    global current_archtype
    global rollback_archtype

    rollback_archtype = current_archtype

    enable_form()

    w.f1.left_button.config(text='Cancel')
    w.f1.left_button.configure(command=cancel_click)

    w.f1.right_button.config(text='Save')
    w.f1.right_button.configure(command=save_click)

def cancel_click():
    global w
    global rollback_archtype

    load_data(rollback_archtype)

    disable_form()

    w.f1.left_button.config(text='Close')
    w.f1.left_button.configure(command=close_click)

    w.f1.right_button.config(text='Edit')
    w.f1.right_button.configure(command=edit_click)

def save_click():
    global save_callback
    global current_archtype

    current_archtype.name = w.f1.ename.get()
    current_archtype.short_Description = w.f1.eshortdescription.get()
    current_archtype.description = w.f1.txtdescription.get("1.0",'end-1c')
    current_archtype.proficiency = w.f1.eproficiency.get()
    current_archtype.str_Bonus = w.f1.estr.get()
    current_archtype.per_Bonus = w.f1.eper.get()
    current_archtype.int_Bonus = w.f1.eint.get()
    current_archtype.dex_Bonus = w.f1.edex.get()
    current_archtype.cha_Bonus = w.f1.echa.get()
    current_archtype.vit_Bonus = w.f1.evit.get()
    current_archtype.mag_Bonus = w.f1.emag.get()
    current_archtype.stamina_Bonus = w.f1.estamina.get()
    current_archtype.attack_Bonus = w.f1.eattack.get()
    current_archtype.reflex_Bonus = w.f1.ereflex.get()
    current_archtype.feats = w.f1.efeats.get()
    current_archtype.movement = w.f1.emvmt.get()
    current_archtype.skill_Points = w.f1.eskillpts.get()
    current_archtype.level_Health = w.f1.elvlhealth.get()

    save_callback(current_archtype)

    disable_form()

    w.f1.left_button.config(text='Close')
    w.f1.left_button.configure(command=close_click)

    w.f1.right_button.config(text='Edit')
    w.f1.right_button.configure(command=edit_click)

def enable_form():
    global w

    w.f1.ename.config(state='normal')
    w.f1.eshortdescription.config(state='normal')
    w.f1.eproficiency.config(state='normal')
    w.f1.estr.config(state='normal')
    w.f1.eper.config(state='normal')
    w.f1.eint.config(state='normal')
    w.f1.edex.config(state='normal')
    w.f1.echa.config(state='normal')
    w.f1.evit.config(state='normal')
    w.f1.emag.config(state='normal')
    w.f1.estamina.config(state='normal')
    w.f1.eattack.config(state='normal')
    w.f1.ereflex.config(state='normal')
    w.f1.efeats.config(state='normal')
    w.f1.emvmt.config(state='normal')
    w.f1.eskillpts.config(state='normal')
    w.f1.elvlhealth.config(state='normal')

def disable_form():
    global w

    w.f1.ename.config(state='disabled')
    w.f1.eshortdescription.config(state='disabled')
    w.f1.eproficiency.config(state='disabled')
    w.f1.estr.config(state='disabled')
    w.f1.eper.config(state='disabled')
    w.f1.eint.config(state='disabled')
    w.f1.edex.config(state='disabled')
    w.f1.echa.config(state='disabled')
    w.f1.evit.config(state='disabled')
    w.f1.emag.config(state='disabled')
    w.f1.estamina.config(state='disabled')
    w.f1.eattack.config(state='disabled')
    w.f1.ereflex.config(state='disabled')
    w.f1.efeats.config(state='disabled')
    w.f1.emvmt.config(state='disabled')
    w.f1.eskillpts.config(state='disabled')
    w.f1.elvlhealth.config(state='disabled')

def load_form(archtype, callback):
    global save_callback
    global original_archtype

    original_archtype = archtype.clone()

    save_callback = callback

    load_data(archtype)

def load_data(archtype):
    global w
    global top_level
    global current_archtype

    current_archtype = archtype.clone()

    top_level.title("Archtype - " + current_archtype.name)
    w.lbltitle.config(text="Archtype - " + current_archtype.name)

    enable_form()

    w.f1.ename.delete(0, 'end')
    w.f1.ename.insert(0, current_archtype.name)

    w.f1.eshortdescription.delete(0, 'end')
    w.f1.eshortdescription.insert(0, current_archtype.short_description)

    w.f1.txtdescription.delete("1.0",'end')
    w.f1.txtdescription.insert('end',current_archtype.description)

    w.f1.eproficiency.delete(0, 'end')
    w.f1.eproficiency.insert(0, current_archtype.proficiency)

    w.f1.estr.delete(0, 'end')
    w.f1.estr.insert(0, current_archtype.str_bonus)

    w.f1.eper.delete(0, 'end')
    w.f1.eper.insert(0, current_archtype.per_bonus)

    w.f1.eint.delete(0, 'end')
    w.f1.eint.insert(0, current_archtype.int_bonus)

    w.f1.edex.delete(0, 'end')
    w.f1.edex.insert(0, current_archtype.dex_bonus)

    w.f1.echa.delete(0, 'end')
    w.f1.echa.insert(0, current_archtype.cha_bonus)

    w.f1.evit.delete(0, 'end')
    w.f1.evit.insert(0, current_archtype.vit_bonus)

    w.f1.emag.delete(0, 'end')
    w.f1.emag.insert(0, current_archtype.mag_bonus)

    w.f1.estamina.delete(0, 'end')
    w.f1.estamina.insert(0, current_archtype.stamina_bonus)

    w.f1.eattack.delete(0, 'end')
    w.f1.eattack.insert(0, current_archtype.attack_bonus)

    w.f1.ereflex.delete(0, 'end')
    w.f1.ereflex.insert(0, current_archtype.reflex_bonus)

    w.f1.efeats.delete(0, 'end')
    w.f1.efeats.insert(0, current_archtype.feats)

    w.f1.emvmt.delete(0, 'end')
    w.f1.emvmt.insert(0, current_archtype.movement)

    w.f1.eskillpts.delete(0, 'end')
    w.f1.eskillpts.insert(0, current_archtype.skill_points)

    w.f1.elvlhealth.delete(0, 'end')
    w.f1.elvlhealth.insert(0, current_archtype.level_health)

    disable_form()

if __name__ == '__main__':
    import GUI_Archtype.py
    GUI_Archtype.py.vp_start_gui()
